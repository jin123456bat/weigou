this.JSON2||(this.JSON2={}),function(){function e(e){return 10>e?"0"+e:e}function t(t,r){var n=Object.prototype.toString.apply(t);return"[object Date]"===n?isFinite(t.valueOf())?t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"Z":null:"[object String]"===n||"[object Number]"===n||"[object Boolean]"===n?t.valueOf():"[object Array]"!==n&&"function"==typeof t.toJSON?t.toJSON(r):t}function f(e){return i.lastIndex=0,i.test(e)?'"'+e.replace(i,function(e){var t=s[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function c(e,r){var n,i,s,h,v,l=o,d=r[e];switch(d&&"object"==typeof d&&(d=t(d,e)),"function"==typeof u&&(d=u.call(r,e,d)),typeof d){case"string":return f(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(o+=a,v=[],"[object Array]"===Object.prototype.toString.apply(d)){for(h=d.length,n=0;h>n;n+=1)v[n]=c(n,d)||"null";return s=0===v.length?"[]":o?"[\n"+o+v.join(",\n"+o)+"\n"+l+"]":"["+v.join(",")+"]",o=l,s}if(u&&"object"==typeof u)for(h=u.length,n=0;h>n;n+=1)"string"==typeof u[n]&&(i=u[n],s=c(i,d),s&&v.push(f(i)+(o?": ":":")+s));else for(i in d)Object.prototype.hasOwnProperty.call(d,i)&&(s=c(i,d),s&&v.push(f(i)+(o?": ":":")+s));return s=0===v.length?"{}":o?"{\n"+o+v.join(",\n"+o)+"\n"+l+"}":"{"+v.join(",")+"}",o=l,s}}var o,a,u,n=(new RegExp("[\x00­؀-؄܏឴឵‌-‏\u2028- ⁠-⁯﻿￰-￿]","g"),'\\\\\\"\x00--­؀-؄܏឴឵‌-‏\u2028- ⁠-⁯﻿￰-￿]'),i=new RegExp("["+n,"g"),s={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};"function"!=typeof JSON2.stringify&&(JSON2.stringify=function(e,t,r){var n;if(o="",a="","number"==typeof r)for(n=0;r>n;n+=1)a+=" ";else"string"==typeof r&&(a=r);if(u=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return c("",{"":e})})}(),function(e){"use strict";function u(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function f(){var n,e="8.0",t=navigator.userAgent.toLowerCase(),r=t.indexOf("msie")>-1;return r&&(n=t.match(/msie ([\d.]+)/)[1],e>=n)?!0:!1}function c(e){return"undefined"!=typeof e}function l(e){return"string"==typeof e||e instanceof String}function v(e){return"object"==typeof e}function d(e){if(!e)return!0;if(l(e)){var t=e.replace(/(\s*$)/g,"");return t.length>0?!1:!0}return!1}function y(){this.key,this.value,this.time=n,this.exps=31536e7,this.ver="v3.2",this.init=function(e){if(l(e)&&""!=e){var t=e.split(",");return this.ver=t[0],this.key=t[1],this.value=t[2],this.time=parseInt(t[3]),this.exps=parseInt(t[4]),!0}return!1},this.isOutTime=function(){return n-this.time>this.exps},this.toStr=function(){return this.ver+","+this.key+","+this.value+","+this.time+","+this.exps}}function b(e){var t=u({mothed:"err",emsg:e.message,ename:e.name,estock:e.stack},k);S.send(i.trackUrl,t,O)}function _(e,t,r){function n(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t=t+"&"+r,void 0!==e[r]&&(t=t+"="+encodeURIComponent(e[r])));return t}if(this.url=e,this.para=t,this.cb=r,this.query="",this.para&&(this.query=n(this.para),this.query.length+this.url.length>2e3)){var i=this.para;i.hasOwnProperty("title")&&(i.title=void 0),i.hasOwnProperty("keywords")&&(i.keywords=void 0),this.query=n(i)}}function j(){function n(t){var r;r=-1==t.url.indexOf("?")?t.url+"?"+t.query:t.url+t.query;var n=e.imgLogData||(e.imgLogData={}),i=new Date,a=n[i]=new Image;a.src=("https:"==m.location.protocol?"https://":"http://")+r,a.onload=a.onerror=function(){t.cb&&t.cb.call(),o(),delete n[i]},a=null}function i(e){function a(){4==t.readyState&&(e.cb&&e.cb.call(),o())}var t=!1;try{t=new XMLHttpRequest}catch(r){try{t=new ActiveXObject("MSXML2.XMLHTTP")}catch(n){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(i){return}}}null!=t&&(t.open("post",("https:"==m.location.protocol?"https://":"http://")+e.url,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(e.query),t.onreadystatechange=a)}function o(){if(r=!0,0==t.length)return void(r=!1);var e=t.shift();e.query.length+e.url.length>2e3&&f()?i(e):n(e)}var t=[],r=!1;this.send=function(e,n,i){var a=new _(e,n,i);t.push(a),r||o()}}function x(e){var e=e||"";return e+Math.round(2147483647*(Math.random()||.5))*+new Date%1e10}function O(){function t(t){var r=(new Date).getTime(),n=w.get_Cookie(t),i=null;return n&&n.ver==e&&r-n.value&&r-n.value<6048e5?i=null:(i=new y,i.ver=e,i.key=t,i.value=r),i}function s(){for(var e in o)S.send(o[e]+"&p="+i+"&random="+x())}if("https:"!=m.location.protocol){var e="v3.4",r="cm",n=t(r),i=k.host,o=function(){return"https:"==m.location.protocol?[]:["cm.mjoys.com/qq.html?time="+(new Date).getTime(),"cm.g.doubleclick.net/pixel?google_nid=mjoys&google_cm&google_sc&google_ula="+k.ula,"cm.mjoys.com/tanxr.html?ula="+k.ula,"cm.pos.baidu.com/pixel?dspid=10347221&ext_data=ula="+k.ula]}();n&&(w.setCookie(n),s())}}function T(e){var t=m.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:function(e){return e=e.match(/[-a-z0-9]+\.(com|cn|com\.cn|me|org|cc|info|net|net\.cn)(?=$)/gi),e&&e.length>0&&(e=e[0]),e}(t.hostname),port:t.port,query:t.search,params:function(){for(var o,e={},r=t.search.replace(/^\?/,"").split("&"),n=r.length,i=0;n>i;i++)r[i]&&(o=r[i].split("="),e[o[0]]=o[1]);return e}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}}function q(e,r,n){if(e){l(e)&&(n=r,r=e,e=t);try{if(e===t)return E[r]=E[r]||[],void E[r].unshift(n);e.addEventListener?e.addEventListener(r,n,!1):e.attachEvent&&e.attachEvent("on"+r,n)}catch(i){}}}function L(e){var t=E[e];if(t){for(var r=[],n=arguments,i=1,o=n.length;o>i;i++)r.push(n[i]);for(var a=0,s=t.length;s--;)t[s].apply(this,r)&&a++;return a}}function M(){try{var e,t,r;for(e=0;e<arguments.length;e+=1)r=arguments[e],t=r.shift(),c(z[t])?z[t].push.apply(z[t],r):(r.unshift(t),z["default"].push.apply(z["default"],r))}catch(n){b(n)}}function N(){return{push:M}}function U(e,t){this.name=e,this.fields=[],this.url=t||i.trackUrl,z[e]=this}function H(){o&&new Date-a<50||s||(s=!0,J.send("unload"))}function I(){var e=window.location.host,t=window.location.pathname,r=x(),n="http://fx.mjoys.com/gdt.gif?dm="+e+"&url="+t+"&rm="+r,i=new Image;i.src=n}var t=e._mjoy||[],r=!1;if(t instanceof Array){var a,s,t=e._mjoy||[],n=(new Date).getTime(),i={version:"v3.2",trackUrl:"fx.mjoys.com/at.gif"},o=e.attachEvent&&!e.opera,p=1,m=function(){var t;try{t=e.top.document}catch(r){if(p=2,e.parent)try{t=e.parent.document}catch(n){t=""}}return""===t&&(t=document),t}(),g=function(){var t;try{t=e.top.location.hostname}catch(r){t=e.location.hostname}return t=t.match(/[-a-z0-9]+\.(com|cn|com\.cn|me|org|cc|info|net|net\.cn)(?=$)/gi),t&&t.length>0&&(t=t[0]),t}(),w={values:{},init:function(){var e=this.readCookie("_mj_c");if(null===e){if(null!=this.readCookie("rtb")){var t=new y;t.key="rtb",t.value=this.readCookie("__mj_rtb_"),t.exps=864e5,this.values.rtb=t,this.writeCookie([["__mj_rtb_",0]],1)}if(null!=this.readCookie("cm")){var r=new y;r.key="cm",r.value=this.readCookie("__mj_cm_"),r.ver="v3.4",this.values.cm=r,this.writeCookie([["__mj_cm_",0]],1)}}else{var n=e.split("|");for(var i in n){var o=new y;o.init(n[i])&&(o.isOutTime()||(this.values[o.key]=o))}}this.write()},readCookie:function(e){var t=e||this.rdCookieKey,r=document.cookie.match(new RegExp("(^| )"+t+"=([^;]*)(;|$)"));return null===r?null:unescape(r[2])},writeCookie:function(e,t){for(var n="/",i=new Date,o=t||31536e7,a="",s=0;s<e.length;s++)a=a+e[s][0]+"="+e[s][1]+";";o>0?(i.setTime(i.getTime()+o),m.cookie=a+"expires="+i.toGMTString()+";path="+n+";domain="+g):m.cookie=a+";path="+n+";domain="+g},write:function(){var e="";for(var t in this.values)this.values.hasOwnProperty(t)&&(e.length>0&&(e+="|"),e+=this.values[t].toStr());e.length>0&&this.writeCookie([["_mj_c",e]])},get_Cookie:function(e){return this.values[e]?this.values[e]:(this.init(),this.values[e]?this.values[e]:null)},setCookie:function(e){this.values[e.key]=e,this.write()}},C=w.get_Cookie("last");null==C&&(C=new y,C.key="last",C.value=0);var k=function(){try{var r,o,a,s,t=navigator,u={},f=e.location;r=f.host,o=f.pathname,a=f.search.substr(1),s=f.hash,a&&function(){for(var e=a.split("&"),t=0,r=e.length;r>t;t++)if(-1!=e[t].indexOf("=")){var n=e[t].indexOf("="),i=e[t].slice(0,n),o=e[t].slice(n+1);u[i]=o}}();var c=m.referrer,h=function(){var e=!1,t=function(e){return d(e)?"":T(e).host}(c);t!=g&&(e=!0),n-C.value>18e5&&(e=!0),C.value=n,w.setCookie(C);var r=w.readCookie("_mj_si");return(e||null==r)&&(r=x("si"),w.writeCookie([["_mj_si",r]],-1)),r}();return{host:r,os:t.platform,lang:t.language||t.browserLanguage,inSize:m.body.clientWidth+"x"+m.body.clientHeight,outSize:e.screen.width+"x"+e.screen.height,charset:m.charset||m.characterSet,title:m.title,ver:i.version,loadtime:n,rd:x("rd"),flag:p,keywords:function(){for(var e="",t=0,r=["Keywords","keywords","KeyWords","keyWords"],n=r.length;n>t;t++)for(var i=0,o=m.getElementsByName(r[t]),a=o.length;a>i;i++)e+=o[i].content;return e}(),referer:c,rtbid:function(){var e=u.rtbid||void 0;if(e){var t=new y;return t.key="rtb",t.value=e,t.exps=864e5,w.setCookie(t),e}return e=w.get_Cookie("rtb"),null===e?"":e.value}(),ula:"3174863",si:h}}catch(l){b(l)}}(),S=new j;O();var A={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",encode:function(e){return this.baseEncode(this.utf16to8(e))},baseEncode:function(e){var t,r,n,i,o,a;for(n=e.length,r=0,t="";n>r;){if(i=255&e.charCodeAt(r++),r==n){t+=this.encodeChars.charAt(i>>2),t+=this.encodeChars.charAt((3&i)<<4),t+="==";break}if(o=e.charCodeAt(r++),r==n){t+=this.encodeChars.charAt(i>>2),t+=this.encodeChars.charAt((3&i)<<4|(240&o)>>4),t+=this.encodeChars.charAt((15&o)<<2),t+="=";break}a=e.charCodeAt(r++),t+=this.encodeChars.charAt(i>>2),t+=this.encodeChars.charAt((3&i)<<4|(240&o)>>4),t+=this.encodeChars.charAt((15&o)<<2|(192&a)>>6),t+=this.encodeChars.charAt(63&a)}return t},utf16to8:function(e){var t,r,n,i;for(t="",n=e.length,r=0;n>r;r++)i=e.charCodeAt(r),i>=1&&127>=i?t+=e.charAt(r):i>2047?(t+=String.fromCharCode(224|i>>12&15),t+=String.fromCharCode(128|i>>6&63),t+=String.fromCharCode(128|i>>0&63)):(t+=String.fromCharCode(192|i>>6&31),t+=String.fromCharCode(128|i>>0&63));return t}},E={},z=[];U.prototype.push=function(e,t){if(l(e)){var r={};r[e]=t,this.fields.push(r)}else v(e)&&(e instanceof Array?this.fields=this.fields.concat(e):this.fields.push(e));L.apply(this,[this.name+".push",e,t])},U.prototype.send=function(e){var t=u({item:A.encode(JSON2.stringify(this.fields))},k);t.mothed=e,t.time=(new Date).getTime()-n,t.time<0&&(t.time=0),S.send(this.url,t)},U.prototype.lazySend=function(e){var t=this;r?this.send(e):setTimeout(function(){t.lazySend(e)},100)},U.prototype.on=function(e,t){q(this.name+"."+e,t)},new U("default").on("push",function(e,t){l(e)&&(k[e]=t)});var J=new U("_item");new U("_order").on("push",function(){if(0!=this.fields.length){var e=this.fields.pop();if(d(e.order.id)){e.order.id=x("o");var t=new y;t.key="od",t.value=e.order.id,t.exps=6e5,w.setCookie(t)}d(e.order.fm)||(k.fm=e.order.fm),this.fields.push(e),this.lazySend("order")}}),new U("_pay").on("push",function(){var e=this.fields.pop();if(d(e.order.id)){var t=w.get_Cookie("od");t||(t={value:x("o")}),e.order.id=t.value}d(e.order.fm)||(k.fm=e.order.fm),this.fields.push(e),this.lazySend("pay")}),new U("_addCart").on("push",function(){this.lazySend("addCart")}),new U("_love").on("push",function(){this.lazySend("collect")});for(var P=0;P<t.length;P++)M(t[P]);o&&q(m,"mouseup",function(e){var t=e.target||e.srcElement;1===t.nodeType&&/^ajavascript:/i.test(t.tagName+t.href)&&(a=new Date)}),q(e,"beforeunload",H),q(e,"unload",H),J.send("load"),e._mjoy=t=new N,r=!0,I()}}(window);